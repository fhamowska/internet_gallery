{% extends 'base.twig' %}

{% block title %}Artworks Gallery{% endblock %}

{% block content %}
    <div class="filter">
        <form action="gallery.php{% if filters %}?{% endif %}{% for key, value in filters %}{% if key == 'genre' and value is iterable %}{% set value = value|join(',') %}{% endif %}{% if value is not empty %}{{ key }}={{ value }}&{% endif %}{% endfor %}" method="GET" class="row">
            <div class="form-group col-md-3">
                <label for="searchTerm">Search:</label>
                <input type="text" class="form-control" name="searchTerm" id="searchTerm" value="{{ filters.searchTerm ?? '' }}">
            </div>
            <div class="form-group col-md-3">
                <label for="genre">Genre:</label><br>
                <select class="form-control" name="genre[]" id="genre" multiple>
                    {% for genre in genres %}
                        <option value="{{ genre.id }}" {% if genre.id in filters.genre %} selected {% endif %}>{{ genre.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for="creationYearFrom">Creation Year From:</label>
                <input type="number" class="form-control" name="creationYearFrom" id="creationYearFrom" min="0" value="{{ filters.creationYearFrom ?? '' }}">
            </div>
            <div class="form-group col-md-3">
                <label for="creationYearTo">Creation Year To:</label>
                <input type="number" class="form-control" name="creationYearTo" id="creationYearTo" min="0" value="{{ filters.creationYearTo ?? '' }}">
            </div>
            <div class="form-group col-md-12">
                <button type="submit" class="btn btn-primary">Apply Filters</button>
            </div>
        </form>
    </div>

    <div class="gallery row">
        {% if artworks %}
            {% for artwork in artworks %}
                <div class="col-md-4">
                    <div class="card mb-4">
                        <img src="{{ artwork.imagePath }}" class="card-img-top" alt="{{ artwork.altText }}">
                        <div class="card-body">
                            <h5 class="card-title">{{ artwork.title }}</h5>
                            <p class="card-text">Artist: <a href="gallery.php?searchTerm={{ artwork.artistName }}{% if filters %}{% for key, value in filters %}{% if value is iterable %}{% set value = value|join(',') %}{% endif %}{% if value is not empty %}&{{ key }}={{ value }}{% endif %}{% endfor %}{% endif %}">{{ artwork.artistName }}</a></p>
                            <p class="card-text">Genre: {{ artwork.genreName }}</p>
                            <p class="card-text">Creation Year: {{ artwork.creationYear }}</p>
                            <p class="card-text">Dimensions: {{ artwork.dimensions }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
            <div class="pagination col-md-12">
                <div class="pagination-info">
                    Page {{ currentPage }} of {{ totalPages }}
                </div>
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        {% if currentPage > 1 %}
                            <li class="page-item">
                                <a class="page-link" href="gallery.php{% if filters %}?{% endif %}{% for key, value in filters %}{% if key == 'genre' and value is iterable %}{% set value = value|join(',') %}{% endif %}{% if value is not empty %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ currentPage - 1 }}">Previous</a>
                            </li>
                        {% endif %}
                        {% if currentPage < totalPages %}
                            <li class="page-item">
                                <a class="page-link" href="gallery.php{% if filters %}?{% endif %}{% for key, value in filters %}{% if key == 'genre' and value is iterable %}{% set value = value|join(',') %}{% endif %}{% if value is not empty %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ currentPage + 1 }}">Next</a>
                            </li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
        {% else %}
            <p>No artworks found.</p>
        {% endif %}
    </div>

{% endblock %}

